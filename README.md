# Разработка и деплой FastAPI-сервисов с использованием Docker

Этот проект включает два микросервиса, созданных с использованием **FastAPI**:
1. **TODO-сервис** — сервис для управления задачами (операции CRUD), данные хранятся в SQLite.
2. **Сервис сокращения URL** — сервис для создания коротких ссылок и получения информации о сокращённых ссылках, также использует SQLite для хранения данных.

Оба сервиса упакованы в Docker-контейнеры для удобства развертывания.

## Содержание
- [Обзор проекта](#обзор-проекта)
- [Технологии](#технологии)
- [Сервисы](#сервисы)
  - [TODO-сервис](#todo-сервис)
  - [Сервис сокращения URL](#сервис-сокращения-url)
- [Запуск с Docker](#запуск-с-docker)
- [Запуск локально](#запуск-локально)
- [API Эндпоинты](#api-эндпоинты)

## Обзор проекта

Проект состоит из двух микросервисов:
- **TODO-сервис**: Сервис для создания, чтения, обновления и удаления задач.
- **Сервис сокращения URL**: Сервис для создания коротких ссылок и получения информации о них.

Для обоих сервисов используется база данных **SQLite**, а Docker используется для контейнеризации сервисов.

## Технологии

- **FastAPI** — фреймворк для создания веб-приложений.
- **SQLite** — база данных для хранения задач и URL.
- **Docker** — контейнеризация сервисов для простоты развертывания и тестирования.
- **Uvicorn** — сервер для запуска FastAPI приложений.

## Сервисы

### TODO-сервис

Этот сервис позволяет управлять списком задач, используя стандартные операции CRUD. Все задачи хранятся в базе данных SQLite.

#### Эндпоинты:
- **POST /items**: Создание новой задачи.
  - Тело запроса: `{ "title": "Заголовок задачи", "description": "Описание задачи", "completed": false }`
- **GET /items**: Получение списка всех задач.
- **GET /items/{item_id}**: Получение задачи по ID.
- **PUT /items/{item_id}**: Обновление задачи по ID.
  - Тело запроса: `{ "title": "Обновлённый заголовок", "description": "Обновлённое описание", "completed": true }`
- **DELETE /items/{item_id}**: Удаление задачи по ID.

### Сервис сокращения URL

Этот сервис позволяет создавать короткие ссылки для длинных URL и получать информацию о сокращённых ссылках.

#### Эндпоинты:
- **POST /shorten**: Создание короткой ссылки.
  - Тело запроса: `{ "url": "https://длинная-ссылка.com" }`
  - Ответ: `{ "short_id": "abc123" }`
- **GET /{short_id}**: Перенаправление на оригинальный URL по короткому идентификатору.
- **GET /stats/{short_id}**: Получение информации о сокращённом URL (например, оригинальная ссылка).

## Запуск с Docker

Каждый сервис имеет свой **Dockerfile** для упрощённого развертывания.

### Шаги для запуска:

1. **Построить Docker-образы** для каждого сервиса:
   - Для TODO-сервиса:
     ```bash
     docker build -t todo_service .
     ```
   - Для сервиса сокращения URL:
     ```bash
     docker build -t shorturl_service .
     ```

2. **Создать Docker-тома** для хранения данных:
   ```bash
   docker volume create todo_data
   docker volume create shorturl_data
   ```

3. **Запустить контейнеры**:
   - TODO-сервис:
     ```bash
     docker run -d -p 8000:80 -v todo_data:/app/data todo_service
     ```
   - Сервис сокращения URL:
     ```bash
     docker run -d -p 8001:80 -v shorturl_data:/app/data shorturl_service
     ```

4. **Доступ к сервисам**:
   - TODO-сервис: [http://localhost:8000/docs](http://localhost:8000/docs)
   - Сервис сокращения URL: [http://localhost:8001/docs](http://localhost:8001/docs)

## Запуск локально

Чтобы запустить сервисы без Docker:

1. **Установить зависимости**:
   ```bash
   pip install -r requirements.txt
   ```

2. **Запустить сервисы с помощью Uvicorn**:
   - Для TODO-сервиса:
     ```bash
     uvicorn todo_app.main:app --reload --host 0.0.0.0 --port 8000
     ```
   - Для сервиса сокращения URL:
     ```bash
     uvicorn shorturl_app.main:app --reload --host 0.0.0.0 --port 8001
     ```

3. **Доступ к сервисам**:
   - TODO-сервис: [http://localhost:8000/docs](http://localhost:8000/docs)
   - Сервис сокращения URL: [http://localhost:8001/docs](http://localhost:8001/docs)

## API Эндпоинты

### TODO-сервис
1. **POST /items**: Создание новой задачи.
2. **GET /items**: Получение всех задач.
3. **GET /items/{item_id}**: Получение задачи по ID.
4. **PUT /items/{item_id}**: Обновление задачи.
5. **DELETE /items/{item_id}**: Удаление задачи.

### Сервис сокращения URL
1. **POST /shorten**: Создание короткой ссылки.
2. **GET /{short_id}**: Перенаправление на оригинальный URL.
3. **GET /stats/{short_id}**: Получение информации о сокращённой ссылке.
